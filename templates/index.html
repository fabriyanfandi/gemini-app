<!DOCTYPE html>
<html>
<head>
    <title>AI Profesi Indonesia Generator</title>
    <style>
        body { font-family: Arial; padding: 30px; text-align: center; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap:20px; margin-top:30px;}
        .spinner {
            border:6px solid #f3f3f3;
            border-top:6px solid #3498db;
            border-radius:50%;
            width:40px;
            height:40px;
            animation:spin 1s linear infinite;
            margin:auto;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        #loader { display:none; margin-top:20px;}
        #notification { margin-top:20px; font-weight:bold;}
    </style>
</head>
<body>

<h2>Upload Foto & Pilih Profesi Indonesia</h2>

<form id="form">
    <input type="file" name="image" required><br><br>

    <div style="text-align:left; display:inline-block;">
        <label><input type="checkbox" name="style" value="presiden"> Presiden</label><br>
        <label><input type="checkbox" name="style" value="dokter"> Dokter</label><br>
        <label><input type="checkbox" name="style" value="tentara"> Tentara</label><br>
        <label><input type="checkbox" name="style" value="polisi"> Polisi</label><br>
        <label><input type="checkbox" name="style" value="guru"> Guru</label><br>
        <label><input type="checkbox" name="style" value="pilot"> Pilot</label><br>
        <label><input type="checkbox" name="style" value="pramugari"> Pramugari</label><br>
        <label><input type="checkbox" name="style" value="pemadam"> Pemadam</label><br>
        <label><input type="checkbox" name="style" value="ojol"> Ojol</label><br>
        <label><input type="checkbox" name="style" value="satpam"> Satpam</label><br>
        <label><input type="checkbox" name="style" value="hakim"> Hakim</label><br>
        <label><input type="checkbox" name="style" value="jaksa"> Jaksa</label><br>
        <label><input type="checkbox" name="style" value="arsitek"> Arsitek</label><br>
        <label><input type="checkbox" name="style" value="chef"> Chef</label><br>
        <label><input type="checkbox" name="style" value="wartawan"> Wartawan</label><br>
        <label><input type="checkbox" name="style" value="petani"> Petani</label><br>
        <label><input type="checkbox" name="style" value="nelayan"> Nelayan</label><br>
        <label><input type="checkbox" name="style" value="montir"> Montir</label><br>
        <label><input type="checkbox" name="style" value="perawat"> Perawat</label><br>
        <label><input type="checkbox" name="style" value="programmer"> Programmer</label><br>
    </div><br><br>

    <button type="submit" id="generateBtn">Generate</button>
</form>

<div id="loader">
    <div class="spinner"></div>
    <p>Generating images... please wait</p>
</div>

<div id="notification"></div>
<div id="results" class="grid"></div>

<script>
const form = document.getElementById("form");
const loader = document.getElementById("loader");
const notification = document.getElementById("notification");
const resultsDiv = document.getElementById("results");
const button = document.getElementById("generateBtn");

form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);

    loader.style.display = "block";
    notification.innerHTML = "";
    resultsDiv.innerHTML = "";
    button.disabled = true;

    try {
        const response = await fetch("/generate", {
            method: "POST",
            body: formData
        });

        const data = await response.json();

        loader.style.display = "none";
        button.disabled = false;

        if (data.results) {
            data.results.forEach(item => {
                if (item.image) {
                    const card = document.createElement("div");
                    card.innerHTML = `
                        <h4>${item.style.toUpperCase()}</h4>
                        <img src="data:image/png;base64,${item.image}" width="100%">
                    `;
                    resultsDiv.appendChild(card);
                }
            });

            notification.innerHTML = "✅ Semua gambar berhasil dibuat!";
            notification.style.color = "green";
        } else {
            notification.innerHTML = "❌ Gagal generate.";
            notification.style.color = "red";
        }

    } catch (err) {
        loader.style.display = "none";
        button.disabled = false;
        notification.innerHTML = "❌ Terjadi error server.";
        notification.style.color = "red";
    }
});
</script>

</body>
</html>